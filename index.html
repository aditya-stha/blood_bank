<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #fafafa;
    margin: 0;
    padding: 1rem;
  }

  h1 {
    text-align: center;
    color: #d32f2f;
    margin-bottom: 1.5rem;
  }

  .filter-section {
    margin-bottom: 1rem;
  }

  select {
    width: 100%;
    padding: 0.6rem;
    font-size: 1rem;
    border-radius: 0.5rem;
    border: 1px solid #ccc;
  }

  .donor-card {
    background: white;
    padding: 1rem;
    margin-bottom: 1rem;
    border-radius: 0.75rem;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
  }

  .donor-info {
    flex: 1 1 auto;
  }

  .blood-badge {
    font-weight: bold;
    color: white;
    padding: 0.3rem 0.6rem;
    border-radius: 0.5rem;
    font-size: 0.9rem;
    min-width: 50px;
    text-align: center;
  }

  .A+ { background: #ff4d4d; }
  .A- { background: #ff6666; }
  .B+ { background: #ffb366; }
  .B- { background: #ffd699; }
  .O+ { background: #66b3ff; color: #fff; }
  .O- { background: #99ccff; color: #fff; }
  .AB+ { background: #cc99ff; }
  .AB- { background: #d9b3ff; }

  .cta-link {
    display: block;
    text-align: center;
    margin-top: 2rem;
    font-size: 1rem;
    color: #d32f2f;
    text-decoration: none;
    font-weight: 500;
  }

  .cta-link:hover {
    text-decoration: underline;
  }

  #donorList p {
    text-align: center;
    color: #666;
    margin-top: 1rem;
  }
</style>
</head>
<body>

<h1>ðŸ©¸ Blood Donor Finder</h1>

<div class="filter-section">
  <label for="bloodType">Select Blood Type:</label>
  <select id="bloodType" onchange="drawDonors()">
    <option value="">-- Select a Blood Type --</option>
    <option value="A+">A+</option>
    <option value="A-">A-</option>
    <option value="B+">B+</option>
    <option value="B-">B-</option>
    <option value="AB+">AB+</option>
    <option value="AB-">AB-</option>
    <option value="O+">O+</option>
    <option value="O-">O-</option>
  </select>
</div>

<div id="donorList">
  <p>Please select a blood type to see donors.</p>
</div>

<a href="https://forms.gle/Yb76YVtzJ6EyYXVZ7" class="cta-link">Register as Donor</a>

<script>
const sheetID = '1Prck0zjCMJh8JC3yZm18Wxt5g-1-359nx5lIaynJv6A';
let allDonors = [];

function fetchDonors(callback) {
  const queryStr = 'SELECT A, B, C';
  const queryUrl = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=Sheet1&tq=${encodeURIComponent(queryStr)}`;

  const query = new google.visualization.Query(queryUrl);
  query.send(response => {
    const data = response.getDataTable();
    const donors = [];
    for (let i = 0; i < data.getNumberOfRows(); i++) {
      donors.push({
        Name: data.getValue(i, 0),
        Phone: data.getValue(i, 1),
        BloodType: data.getValue(i, 2)
      });
    }
    allDonors = donors;
    if (callback) callback();
  });
}

function drawDonors() {
  const filter = document.getElementById('bloodType').value;
  const donorListDiv = document.getElementById('donorList');
  donorListDiv.innerHTML = '';

  if (!filter) {
    donorListDiv.innerHTML = '<p>Please select a blood type to see donors.</p>';
    return;
  }

  const filtered = allDonors.filter(d => d.BloodType === filter);

  if (filtered.length === 0) {
    donorListDiv.innerHTML = `<p>No ${filter} donors found.</p>`;>;
    return;
  }

  filtered.forEach(d => {
    const card = document.createElement('div');
    card.className = 'donor-card';
    card.innerHTML = `
      <div class="donor-info">
        <strong>${d.Name}</strong><br>
        <a href="tel:${d.Phone}">${d.Phone}</a>
      </div>
      <div class="blood-badge ${d.BloodType.replace('+','plus').replace('-','minus')}">
        ${d.BloodType}
      </div>
    `;
    donorListDiv.appendChild(card);
  });
}

google.charts.load('current', {'packages':['table']});
google.charts.setOnLoadCallback(() => fetchDonors());
</script>

</body>
</html>
